<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:p="http://primefaces.org/ui"
	  >
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title></title>

	<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<style>
		.alert {
			display: block;
			font-family: Arial;
			padding: 15px;
			margin-bottom: 20px;
			border: 1px solid transparent;
			border-radius: 4px;
		}
		.alert-warning {
			color: #8a6d3b;
			background-color: #fcf8e3;
			border-color: #faebcc;
		}
		.alert-info {
			 color: #3c763d;
			 background-color: #dff0d8;
			 border-color: #d6e9c6;
		}
		.alert-danger {
			 color: #a94442;
			 background-color: #f2dede;
			 border-color: #ebccd1;
		}
	</style>
</h:head>
<h:body>
	<h:form id="form01">
		<div class="navbar">
	    <div class="navbar-inner">
	      <div class="container">
	        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
	          <span class="icon-bar"></span>
	          <span class="icon-bar"></span>
	          <span class="icon-bar"></span>
	        </a>
	        <a class="brand" href="#">Ardemis</a>
	        <div class="nav-collapse collapse navbar-responsive-collapse">
	          <ul class="nav">
	            <li class="active"><a href="#">Home</a></li>
	            <li><a href="#{sessionController.dashboardLink()}">Dashboard</a></li>
	            <li><h:commandLink action="#{listingController.toEmployeePage}" value="Employee Page" /></li>
	            <li class="dropdown">
	              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reports<b class="caret"></b></a>
	              <ul class="dropdown-menu">
	                <li><a href="../faces/expense.jsf">Sale expense summary</a></li>
	                <li><a href="../faces/report.jsf">Sale records</a></li>
	                <li><a href="../faces/report.jsf">Add new purchase</a></li>
	              </ul>
	            </li>
	            <li><a href="notes.jsf">Notes</a></li>
	            <li><a href="products.jsf">Products</a></li>
	            <li class="dropdown">
	              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Product Catalog<b class="caret"></b></a>
	              <ul class="dropdown-menu">
	                <li><h:outputLink value="#{request.contextPath}/faces/products.jsf">Products List</h:outputLink></li>
	                <li><a href="../products/AutoCAD.jsf">AutoCAD</a></li>
	                <li><a href="../products/quickdesk.jsf">Quickdesk</a></li>
	                <li class="divider"></li>
	                <li class="nav-header">Works Suite</li>
	                <li><a href="../products/Revit.jsf">Revit</a></li>
	                <li><a href="../products/Stormworks.jsf">Stormworks</a></li>
	              </ul>
	            </li>
	            <li><h:commandLink value="Log out" action="#{salespersonController.logout}" /></li>
	          </ul>
	          </div>
				</div>
			</div>
		</div>


		<p:selectOneMenu value="#{sessionController.currency}">
			<f:selectItem itemValue="0" itemLabel="Select " />
			<f:selectItems value="#{sessionController.currencyList}" />
			<p:ajax listener="#{salespersonController.reload}" update="form01"/>
		</p:selectOneMenu>

		<h:messages infoClass="alert alert-success" errorClass="alert alert-error" fatalClass="alert alert-block" />

		<p:dataTable id="table1" rowIndexVar="row" value="#{salespersonController.customerList}" var="comp"
				paginator="true" paginatorTemplate="{PreviousPageLink} {CurrentPageReport} {NextPageLink}"
				rows="15" rowKey="#{comp.seq}">

			<p:column headerText="Name">
				<h:outputText value="#{comp.name}" />
			</p:column>
			<p:column headerText="Size">
				<h:outputText value="#{comp.size}" />
			</p:column>
			<p:column headerText="Industry">
				<h:outputText value="#{comp.industry}" />
			</p:column>
			<p:column headerText="Type">
				<h:outputText value="#{comp.type}" />
			</p:column>
			<p:column headerText="Year Founded">
				<h:outputText value="#{comp.yearFounded}" />
			</p:column>
			<p:column headerText="Location">
				<h:outputText value="#{comp.location}" />
			</p:column>
			<p:column headerText="Phone">
				<h:outputText value="#{comp.phone}" />
			</p:column>
			<p:column headerText="Remark">
				<h:outputText value="#{comp.remark}" />
			</p:column>

			<p:column headerText="Link">
				<h:outputLink value="#{salespersonController.link(comp.name)}" target="_blank" style="color: blue;">Google news</h:outputLink>
				<p:spacer width="20" />
				<a href="history.jsf?seq=#{comp.seq}" style="color: blue;">Detail</a>
				<p:spacer width="20" />
				<h:commandButton value="Delete" actionListener="#{salespersonController.remove(comp)}" update="form01"
					rendered="#{facesContext.externalContext.isUserInRole('admin') or facesContext.externalContext.isUserInRole('manager') or facesContext.externalContext.isUserInRole('support')}"/>
				<p:spacer width="20" />
				<a href="editCompany.jsf?seq=#{comp.seq}" style="color: blue;">Edit</a>
			</p:column>
		</p:dataTable>

		<br/>
		<p:commandButton value="Add new customer" actionListener="#{salespersonController.startAdd}" oncomplete="custDialog_w.show()" update=":form01"/>
		<br/>

		<p:panelGrid columns="3">
			<h:outputText value="Search" />
			<p:inputText binding="#{a}"/>
			<p:commandButton actionListener="#{salespersonController.search(a.value)}" value="Search" update=":form01" />
		</p:panelGrid>

		<p:dialog id="custDialog" closable="false" widgetVar="custDialog_w" rendered="#{salespersonController.addMode}" visible="#{salespersonController.addMode}"
				modal="true" resizable="false" draggable="true" header="Customer detail">
			<p:panelGrid columns="3">
				<h:outputText value="Name*" />
				<p:inputText id="comName" value="#{salespersonController.newCust.name}" required="true"
					requiredMessage="Name is required" validator="#{salespersonController.validateCompName}"/>
				<p:message for="comName" />

				<h:outputText value="Company size" />
				<p:inputText id="comSize" value="#{salespersonController.newCust.size}" />
				<p:message for="comSize" />

				<h:outputText value="Industry*" />
				<p:inputText id="comInd" value="#{salespersonController.newCust.industry}" required="true" requiredMessage="Industry is required"/>
				<p:message for="comInd" />

				<h:outputText value="Type" />
				<p:inputText id="comType" value="#{salespersonController.newCust.type}" />
				<p:message for="comType" />

				<h:outputText value="Year founded" />
				<p:inputText id="comYear" value="#{salespersonController.newCust.yearFounded}" />
				<p:message for="comYear" />

				<h:outputText value="Location*" />
				<p:inputText id="comLocation" value="#{salespersonController.newCust.location}" required="true" requiredMessage="Location is required" />
				<p:message for="comLocation" />

				<h:outputText value="Phone*" />
				<p:inputText id="comPhone" value="#{salespersonController.newCust.phone}" required="true" requiredMessage="Phone is required">
					<f:validator validatorId="phoneValidator" />
				</p:inputText>
				<p:message for="comPhone" />

				<h:outputText value="Remark" />
				<p:inputText id="comRemark" value="#{salespersonController.newCust.remark}" />
				<p:message for="comRemark" />

				<h:outputText value="* = required fields" />
				<h:outputText value="" />
				<h:outputText value="" />
			</p:panelGrid>

			<p:commandButton value="Apply" ajax="true" actionListener="#{salespersonController.addNewCompany}" update=":form01"
				oncomplete="if (args &amp;&amp; !args.validationFailed) custDialog_w.hide()" />

			<p:commandButton id="cancelBtn" value="Cancel" ajax="true" actionListener="#{salespersonController.cancel}" update="@all" immediate="true" />

			</p:dialog>





	</h:form>
</h:body>
</html>