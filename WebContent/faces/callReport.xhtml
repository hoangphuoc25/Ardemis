<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:p="http://primefaces.org/ui"
	  >
	  <f:metadata>
	  	<f:event listener="#{callReportController.reload}" type="preRenderView"></f:event>
	  </f:metadata>
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title></title>
</h:head>
<h:body>
	<h:form id="form01">

		<p:menubar>
			<p:menuitem value="Dashboard" url="#{sessionController.dashboardLink}" />
			<p:submenu label="Products Catalog" >
				<p:menuitem style="color: blue;" value="AutoCAD" url="../products/AutoCAD.jsf" />
				<p:menuitem style="color: blue;" value="QuickDesk" url="../products/quickdesk.jsf" />
				<p:menuitem style="color: blue;" value="Revit" url="../products/Revit.jsf" />
				<p:menuitem style="color: blue;" value="Stormworks" url="../products/Stormworks.jsf" />
			</p:submenu>
			<p:submenu label="Reports">
				<p:menuitem value="Call Report" url="../faces/calls.jsf" />
				<p:menuitem value="Add call report" url="../faces/callReport.jsf" />
			</p:submenu>
			<p:menuitem value="Products" url="../faces/products.jsf" />
			<p:menuitem value="Feedback" url="../customers/customers.jsf" />
			<p:menuitem value="Customers" url="../faces/companyList.jsf" />
			<p:menuitem value="Notes" url="../faces/notes.jsf" />
			<p:menuitem value="LOG OUT" style="float: right" action="#{scheduleController.logout}" immediate="true" update="form01" />
		</p:menubar>

		<h:messages />
		<h3 style="font-family: Helvetica">Add new call report</h3>
		<p:panelGrid columns="2">
			<h:outputText value="Company Name" />
			<p:autoComplete minQueryLength="3" maxResults="10" completeMethod="#{callReportController.suggestCompany}" value="#{callReportController.companyName}" forceSelection="true" >
			</p:autoComplete>

			<h:outputText value="Call time" />
			<p:calendar value="#{callReportController.callTime}" pattern="MM/dd/yyyy HH:mm" />

			<h:outputText value="Detail" />
			<p:inputTextarea value="#{callReportController.callDetail}" />

			<h:outputText value="Rating" />
			<p:selectOneMenu value="#{callReportController.rating}" >
				<f:selectItems value="#{callReportController.ratings}" />
			</p:selectOneMenu>

			<h:outputText value="Rating" />
			<p:autoComplete minQueryLength="3" maxResults="10" value="#{callReportController.productName}" completeMethod="#{callReportController.suggestProd}" forceSelection="true" />
		</p:panelGrid>
		<p:commandButton value="Submit" actionListener="#{callReportController.addNewReport}" update="form01" />
		<br/>
		<a href="companyList.jsf" style="color: blue;">Add new company</a>

		<p:commandButton value="Add new company" actionListener="#{callReportController.startAdd}" update=":form01"/>

		<p:dialog id="custDialog" closable="false" widgetVar="custDialog_w" visible="#{callReportController.addMode}" rendered="#{callReportController.addMode}"
				modal="true" resizable="false" draggable="true" header="Customer detail">
			<p:panelGrid columns="3">
				<h:outputText value="Name*" />
				<p:inputText id="comName" value="#{callReportController.newCust.name}" required="true"
					requiredMessage="Name is required" validator="#{callReportController.validateCompName}"/>
				<p:message for="comName" />

				<h:outputText value="Company size" />
				<p:inputText id="comSize" value="#{callReportController.newCust.size}" />
				<p:message for="comSize" />

				<h:outputText value="Industry*" />
				<p:inputText id="comInd" value="#{callReportController.newCust.industry}" required="true" requiredMessage="Industry is required"/>
				<p:message for="comInd" />

				<h:outputText value="Type" />
				<p:inputText id="comType" value="#{callReportController.newCust.type}" />
				<p:message for="comType" />

				<h:outputText value="Year founded" />
				<p:inputText id="comYear" value="#{callReportController.newCust.yearFounded}" />
				<p:message for="comYear" />

				<h:outputText value="Location*" />
				<p:inputText id="comLocation" value="#{callReportController.newCust.location}" required="true" requiredMessage="Location is required" />
				<p:message for="comLocation" />

				<h:outputText value="Phone*" />
				<p:inputText id="comPhone" value="#{callReportController.newCust.phone}" required="true" requiredMessage="Phone is required">
					<f:validator validatorId="phoneValidator" />
				</p:inputText>
				<p:message for="comPhone" />

				<h:outputText value="Remark" />
				<p:inputText id="comRemark" value="#{callReportController.newCust.remark}" />
				<p:message for="comRemark" />

				<h:outputText value="* = required fields" />
				<h:outputText value="" />
				<h:outputText value="" />
			</p:panelGrid>
			<p:commandButton value="Apply" ajax="true" actionListener="#{callReportController.addNewCompany}" update=":form01"
				oncomplete="if (args &amp;&amp; !args.validationFailed) custDialog_w.hide()" />
			<p:commandButton id="cancelBtn" value="Cancel" ajax="true" actionListener="#{callReportController.cancel}" update="@all" immediate="true" />
		</p:dialog>
	</h:form>
</h:body>
</html>